[gd_scene load_steps=10 format=2]

[ext_resource path="res://assets/ground.tres" type="Material" id=1]
[ext_resource path="res://assets/wall.tres" type="Material" id=2]
[ext_resource path="res://aban/data/data.gd" type="Script" id=3]

[sub_resource type="GDScript" id=1]
script/source = "extends Node


onready var data : Data = $\"../../Data\"


func _ready() -> void:
	data.show_camera.current = true
	data.is_on_show = true
	queue_free()
	
"

[sub_resource type="GDScript" id=2]
script/source = "extends Node


const SPEED : float = -50.0

onready var data : Data = $\"../../Data\"


func _process(delta : float) -> void:
	if data.is_on_show:
		data.show_node.rotate_y(deg2rad(delta * SPEED))
"

[sub_resource type="GDScript" id=3]
script/source = "extends Node


var initial_show_node_y_rot : float
var initial_show_cam_trans : Transform

onready var data : Data = $\"../../Data\"


func _input(event : InputEvent) -> void:
	if data.is_on_show:
		if event.is_action_pressed(\"start\"):
			data.is_on_show = false
			# start_initiation
			initial_show_node_y_rot = data.show_node.rotation.y
			initial_show_cam_trans = data.show_camera.transform
			$Tween.interpolate_method(self, \"initiate\", 0, 1, 2, Tween.TRANS_LINEAR, Tween.EASE_IN)
			$Tween.start()


func initiate(time : float) -> void:
	data.show_node.rotation.y = lerp_angle(initial_show_node_y_rot, 0, time)
	data.show_camera.transform = initial_show_cam_trans.interpolate_with(data.player_camera.transform, time)
	data.show_camera.fov = lerp(70, 120, time)


func _on_Tween_tween_all_completed() -> void:
	data.player_camera.current = true
"

[sub_resource type="PlaneMesh" id=4]
size = Vector2( 60, 56 )

[sub_resource type="ProceduralSky" id=5]

[sub_resource type="Environment" id=6]
background_mode = 2
background_sky = SubResource( 5 )
background_sky_custom_fov = 80.0

[node name="Main" type="Node"]

[node name="Data" type="Node" parent="."]
script = ExtResource( 3 )

[node name="Systems" type="Node" parent="."]

[node name="SetupGame" type="Node" parent="Systems"]
script = SubResource( 1 )

[node name="RotateShow" type="Node" parent="Systems"]
script = SubResource( 2 )

[node name="InitiatePlay" type="Node" parent="Systems"]
script = SubResource( 3 )

[node name="Tween" type="Tween" parent="Systems/InitiatePlay"]

[node name="Scene" type="Node" parent="."]

[node name="Map" type="Node" parent="Scene"]

[node name="Ground" type="MeshInstance" parent="Scene/Map"]
mesh = SubResource( 4 )
material/0 = ExtResource( 1 )
__meta__ = {
"_edit_lock_": true
}

[node name="Borders" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
use_collision = true
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="Bottom" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -31, 1, 0 )
depth = 54.0

[node name="Top" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 31, 1, 0 )
depth = 54.0

[node name="LeftBottom" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 1, -28 )
width = 24.0

[node name="RightBottom" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 1, 28 )
width = 24.0

[node name="LeftTop" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 22, 1, -28 )
width = 20.0

[node name="RightTop" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 22, 1, 28 )
width = 20.0

[node name="LeftLittle" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -19, 1, -25 )
depth = 4.0

[node name="RightLittle" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -19, 1, 25 )
depth = 4.0

[node name="MiddleOne" type="CSGBox" parent="Scene/Map/Borders"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 26, 1, 0 )
width = 8.0

[node name="Anchors" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
use_collision = true
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="LeftAnchor" type="CSGBox" parent="Scene/Map/Anchors"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -25, 1, -14 )
depth = 18.0

[node name="LeftAnchorOne" type="CSGBox" parent="Scene/Map/Anchors"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -21, 1, -12 )
width = 6.0

[node name="RightAnchor" type="CSGBox" parent="Scene/Map/Anchors"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -25, 1, 14 )
depth = 18.0

[node name="RightAnchorOne" type="CSGBox" parent="Scene/Map/Anchors"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -21, 1, 12 )
width = 6.0

[node name="TShapes" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="BottomBottomTHandle" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -23, 1, 0 )
width = 6.0

[node name="BottomBottomTHead" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -19, 1, 0 )
depth = 14.0

[node name="BottomTHandle" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -11, 1, 0 )
width = 6.0

[node name="BottomTHead" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -7, 1, 0 )
depth = 14.0

[node name="TopTHandle" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 13, 1, 0 )
width = 6.0

[node name="TopTHead" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 17, 1, 0 )
depth = 14.0

[node name="LeftTHandle" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 11, 1, -8 )
depth = 6.0

[node name="LefTHead" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 11, 1, -12 )
width = 14.0

[node name="RightTHandle" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 11, 1, 8 )
depth = 6.0

[node name="RightTHead" type="CSGBox" parent="Scene/Map/TShapes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 11, 1, 12 )
width = 14.0

[node name="Corners" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
use_collision = true
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="LeftCornerHead" type="CSGBox" parent="Scene/Map/Corners"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 1, -20 )
depth = 6.0

[node name="LeftCornerHandle" type="CSGBox" parent="Scene/Map/Corners"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -17, 1, -18 )
width = 6.0

[node name="RightCornerHead" type="CSGBox" parent="Scene/Map/Corners"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 1, 20 )
depth = 6.0

[node name="RightCornerHandle" type="CSGBox" parent="Scene/Map/Corners"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -17, 1, 18 )
width = 6.0

[node name="Lines" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="BottomLeft" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 1, -9 )
depth = 8.0

[node name="BottomRight" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 1, 9 )
depth = 8.0

[node name="LeftOne" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, -12 )
width = 8.0

[node name="RightOne" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, 12 )
width = 8.0

[node name="TopLeft" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 17, 1, -20 )
depth = 6.0

[node name="TopRight" type="CSGBox" parent="Scene/Map/Lines"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 17, 1, 20 )
depth = 6.0

[node name="Boxes" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="MostLeft" type="CSGBox" parent="Scene/Map/Boxes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 24, 1, -20 )
width = 4.0
depth = 6.0

[node name="Left" type="CSGBox" parent="Scene/Map/Boxes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 24, 1, -9 )
width = 4.0
depth = 8.0

[node name="Right" type="CSGBox" parent="Scene/Map/Boxes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 24, 1, 10 )
width = 4.0
depth = 8.0

[node name="MostRight" type="CSGBox" parent="Scene/Map/Boxes"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 24, 1, 20 )
width = 4.0
depth = 6.0

[node name="Gates" type="CSGCombiner" parent="Scene/Map"]
material_override = ExtResource( 2 )
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="LeftBottom" type="CSGBox" parent="Scene/Map/Gates"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, -23 )
width = 8.0
depth = 12.0

[node name="LeftTop" type="CSGBox" parent="Scene/Map/Gates"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 1, -23 )
width = 8.0
depth = 12.0

[node name="RightBottom" type="CSGBox" parent="Scene/Map/Gates"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 1, 23 )
width = 8.0
depth = 12.0

[node name="RightTop" type="CSGBox" parent="Scene/Map/Gates"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 1, 23 )
width = 8.0
depth = 12.0

[node name="PlayerCamera" type="Camera" parent="Scene"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -16, 1, 0 )
fov = 120.0
__meta__ = {
"_edit_lock_": true
}

[node name="Show" type="Spatial" parent="Scene"]
__meta__ = {
"_edit_group_": true,
"_edit_lock_": true
}

[node name="ShowCamera" type="Camera" parent="Scene/Show"]
transform = Transform( 1, 0, 0, 0, 0.939693, 0.34202, 0, -0.34202, 0.939693, 0, 20, 45 )

[node name="AnimationPlayer" type="AnimationPlayer" parent="Scene"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Scene"]
environment = SubResource( 6 )
[connection signal="tween_all_completed" from="Systems/InitiatePlay/Tween" to="Systems/InitiatePlay" method="_on_Tween_tween_all_completed"]
